<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>案件詳情</title>

    <script src="statics/jquery-3.4.1.min.js" ></script>
    <link rel="stylesheet" type="text/css" href="statics/css/design_case.css">

</head>


<body>	
	<div id="container">

		<div id="header">
			<img src="logo.png" alt="Italian Trulli" width="80" height="60">
		</div>

		<div id="content">

			<h2>案件編號:NO.</h2>

			<h3>上課內容</h3><hr>

			<div>對象:</div>
			<div>上課科目:</div>
			<div>上課地點:</div>
			<div>薪資待遇:</div>
			<div>上課時間:</div>

			<h3>老師條件需求</h3><hr>

			<div>教學經驗:</div>

			<div id="secend_content"></div>
					<div class="submit"><input type="button" value="我要應徵" id="submit"></div>
			
		</div>
	</div>
	<script>
	  //取得網址參數
	  var url_string = window.location.href;
	  var url = new URL(url_string);
	  var id = url.searchParams.get("id");
	  
	  function getCaseData() {
		  $.ajax({
	          type: "GET",
	          url: "api/case.do",
	          data: "id=" + id,
	          crossDomain: true,
	          cache: false,
	          dataType: 'json',
	          timeout: 5000,
	          success: function (response) {
	              if(response.status == 200){
	            	  updateHTML(response.response.data);
	              }
	          },
	          error: function () {
	              alert("無法連線到伺服器！");
	          }
	    });
	  }
	  
	  getCaseData();
	  
	  function updateHTML(data) {
		  $("#order_id").html(data['order_info']['id']);
		  $("#create").html(data['order_info']['create']);
		  $("#modify").html(data['order_info']['modify']);
		  $("#email").html(data['order_info']['email']);
		  $("#address").html(data['order_info']['address']);
		  $("#phone").html(data['order_info']['phone']);
		  $("#first_name").html(data['order_info']['first_name']);
		  $("#last_name").html(data['order_info']['last_name']);
		  $("#item").html(data.product_info.length);
		  
		  var total_price = Big(0.0);
		  var quantity = 0;
		  var inner_html = "";
		  
		  $.each(data.product_info, function (k, v) {
			  quantity += v['quantity'];
			  total_price = total_price.plus(v['subtotal']);
			  inner_html += updateOrderProductTable(v);
		  });
		  
		  $("#quantity").html(quantity);
		  $("#total").html(total_price.toString());
		  
		  $("#table > tbody").empty();
		  $("#panel").append(inner_html);
	
	  }
	  
	  function updateOrderProductTable(data) {
		  var table_html = "";
		  table_html += '<tr id="row_' + data.id + '">';
	    table_html += '<td class="align-middle text-center">' + data.product.id + '</td>';
	    table_html += '<td class="align-middle"><p class="text-break">' + data.product.name + '</p></td>';
	    table_html += '<td class="align-middle text-center"><span id="price_' + data.id + '">' + data.price + '</td>';
	    table_html += '<td class="align-middle text-center">' + data.quantity + '</td>';
	    table_html += '<td class="align-middle text-center"><strong><span id="subtotal_' + data.id + '">' + data.subtotal + '<strong></td>';
	    table_html += '</tr>';
		  
		  return table_html;
		  
	  }
	  </script>
</body>
</html>