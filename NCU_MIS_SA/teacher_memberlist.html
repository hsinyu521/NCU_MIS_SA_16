<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>老師會員清單</title>

    <script src="statics/jquery-3.4.1.min.js" ></script>
    <link rel="stylesheet" type="text/css" href="statics/css/teacher_memeberlist.css">

</head>


<body>

    <div id="container">

        <div id="header">

            <img src="logo.png" alt="Italian Trulli" width="80" height="60">
            老師會員清單
        </div>

        <div id="content">
<!--            <div id="next_content"></div> -->


            <div id="parents" >
                <table id="table" border="1" solid #888888>
                <thead>
                         <tr>
                            <td>id</td>
                            <td>姓名</td>
                            <td>信箱</td>
                            <td>手機</td>
                            <td>性別</td>
                             <td>密碼</td>
                            <td>功能</td>
                        </tr>
                 </thead>
                 <tbody>
                </tbody>
                </table>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        // 全域變數紀錄SQL指令下的次數
        var sql_num = 0;
        function deleteMember(id) {
            var check = window.confirm("確認刪除會員？");
            if (check == true) {
                console.log("You pressed OK!");
                var request = {'id': id};
                var data_string = JSON.stringify(request);
                $.ajax({
                    type: "DELETE",
                    url: "api/member.do",
                    crossDomain: true,
                    data: data_string,
                    cache: false,
                    dataType: 'json',
                    timeout: 5000,
                    success: function (response) {
                        if(response.status == 200){
                            $("#flashMessage").html("成功! 已經成功刪除會員...");
                            $("#flashMessage").show();
                            getAllMember();
                        }
                        console.log(response);
                    },
                    error: function () {
                        alert("無法連線到伺服器！");
                    }
                });
            }
            else {
                console.log("You pressed Cancel!");
            }
        }

        function getAllParent() {
            // 發出POST的GET請求取得所有會員列表
            $.ajax({
                type: "GET",
                url: "api/member.do",
                crossDomain: true,
                cache: false,
                dataType: 'json',
                timeout: 5000,
                success: function (response) {
                    if(response.status == 200){
                        updateTable(response.response.data);
                    }
                    console.log(response);
                },
                error: function () {
                    alert("無法連線到伺服器！");
                }
            });
        }

        // 更新會員列表表格
        function updateTable(data) {
            $("#table > tbody").empty();
            var table_html = '';
            $.each(data, function(index, value) {
                table_html += '<tr><td scope="row">' + value['id'] + '</td>';
                table_html += '<td>' + value['id'] + '</td>';
                table_html += '<td>' + value[''] + '</td>';
                table_html += '<td>' + value[''] + '</td>';
                table_html += '<td>' + value[''] + '</td>';
                table_html += '<td>' + value[''] + '</td>';
                table_html += '<td>' + value[''] + '</td>';
                table_html += '<td>' + value['login_times'] + '</td>';
                table_html += '<td>' + value['status'] + '</td>';
            })

            $("#table > tbody").append(table_html);
        }
            </script>


</body>
</html>